<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Brew Bubbles - Settings</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon-16x16.png">

    <style>
        body {padding-top: 5rem; padding-bottom: 5rem;}

        .row-padded {
            padding: 0.75rem 1.25rem;
        }

    </style>
</head>

<body>

<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
    <a class="navbar-brand" href="/">Brew Bubbles</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsMain" aria-controls="navbarsMain" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarsMain">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" href="/">Home</a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" href="/settings.htm">Settings <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/about.htm">About</a>
            </li>
        </ul>
    </div>
</nav>

<main role="main" class="container">

    <h4>Update Settings</h4>

    <div id="settingsapp">
        <div class="row row-padded">
            <div class="col-12">
                <div class="card">
                    <h5 class="card-header">
                        Brew Bubbles Settings
                    </h5>

                    <div class="card-body">
                        <p class="card-text">These settings apply to Brew Bubbles as a whole</p>
                        <form action="/settings/update/" method="POST">
                            <div class="form-group row">
                                <label for="mdnsID" class="col-sm-2 col-form-label" data-toggle="tooltip" title="mDNS name (the xxxx in http://xxxx.local/)">mDNS ID</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" name="mdnsID" id="mdnsID" placeholder="brewbubbles" :value="settings.mdnsID">
                                </div>
                                <div class="col-sm-2"><button type="submit" class="btn btn-primary">Update</button></div>
                            </div>
                        </form>

                    </div>
                </div>

            </div>
        </div>


        <div class="row row-padded">
            <div class="col-12">
                <div class="card">
                    <h5 class="card-header">
                        Target Settings
                    </h5>
                    <div class="card-body">
                        <p class="card-text">These settings control how Brew Bubbles talks to an HTML endpoint such as 
                            <a href="https://www.brewpiremix.com/">BrewPi Remix</a> or
                            <a href="https://www.fermentrack.com/">Fermentrack</a>. To disable pushing to the endpoint,
                            delete the URL.
                        </p>
                        <form action="/settings/update/" method="POST">
                            <div class="form-group row">
                                <label for="endpointURL" class="col-sm-2 col-form-label" data-toggle="tooltip" title="HTML Endpoint URL. Delete to disable pushing to an HTML Endpoint">HTML Endpoint URL</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" name="brewpiremixURL" id="brewpiremixURL" placeholder="http://127.0.0.1/brewbubbles/" :value="settings.brewpiremixURL">
                                    <!-- Ports other than 80 need to be in the format of: http://192.168.168.199:8080/ -->
                                </div>
                                <div class="col-sm-2"><button type="submit" class="btn btn-primary">Update</button></div>
                            </div>
                        </form>

                        <form action="/settings/update/" method="POST">
                            <div class="form-group row">
                                <label for="endpointPushEvery" class="col-sm-2 col-form-label" data-toggle="tooltip" title="How often (in seconds) to push data to HTML Endpoint">Push Frequency</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" name="endpointPushEvery" id="endpointPushEvery" placeholder="60" :value="settings.endpointPushEvery">
                                </div>
                                <div class="col-sm-2"><button type="submit" class="btn btn-primary">Update</button></div>
                            </div>
                        </form>

                    </div>
                </div>
            </div>
        </div>


        <div class="row row-padded">
            <div class="col-12">
                <div class="card">
                    <h5 class="card-header">
                        Brewer's Friend Settings
                    </h5>
                    <div class="card-body">
                        <p class="card-text">
                            These settings control how Brew Bubbles talks to <a href="http://www.brewersfriend.com/">Brewer's
                            Friend.</a> With a premium account, Brewer's Friend supports logging from gravity sensors such
                            as the Tilt Hydrometer. To find your API key, log into your Brewer's Friend account and go
                            to Profile > Account. Your API key will be a string of letters and numbers (not a URL).
                        </p>
                        <form action="/settings/update/" method="POST">
                            <div class="form-group row">
                                <label for="brewersFriendKey" class="col-sm-2 col-form-label" data-toggle="tooltip" title="Your Brewers Friend API key">Brewers Friend API Key</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" name="brewersFriendKey" id="brewersFriendKey" placeholder="000fa2ac454c1abf14ffa3" :value="settings.brewersFriendKey">
                                </div>
                                <div class="col-sm-2"><button type="submit" class="btn btn-primary">Update</button></div>
                            </div>
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </div>

</main>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.7/dist/vue.js"></script>

<script type="text/javascript">
    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    });

    var vm = new Vue({
        el: '#settingsapp',
        data: {
            settings: []
        },
        mounted: function () {
            this.getSettings();
        },
        methods: {
            getSettings: function() {
                var xhr = new XMLHttpRequest();
                var self = this;
                xhr.open('GET', '/settings/json/');
                xhr.onload = function () {
                    self.settings = JSON.parse(xhr.responseText);
                };
                xhr.send()
            }
        }
    });
</script>


</body>
</html>