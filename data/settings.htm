<!-- Copyright (C) 2019 Lee C. Bussy (@LBussy)

This file is part of Lee Bussy's Brew Bubbles (Brew-Bubbles).

Brew Bubbles is free software: you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the
Free Software Foundation, either version 3 of the License, or (at your
option) any later version.

Brew Bubbles is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU 
General Public License for more details.

You should have received a copy of the GNU General Public License along
with Brew Bubbles. If not, see <https://www.gnu.org/licenses/>. -->

<!doctype html>
<html lang="en" class="h-100">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta name="description" content="Brew Bubbles, a Home Brewing application">
    <meta name="author" content="Lee Bussy">

    <title>Brew Bubbles</title>

    <link rel="canonical" href="https://www.brewbubbles.com/">

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta name="apple-mobile-web-app-title" content="Brew Bubbles">
    <meta name="application-name" content="Brew Bubbles">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="msapplication-config" content="/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="https://bootswatch.com/4/united/bootstrap.css"
        integrity="sha384-GuVYG0jqJkyF0Z6LyLuimzKIsbFyMvgtCUeAX3v/Mr+rBBK4qsoQk0yP6xB+RDzc" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
        integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <link rel="stylesheet" href="https://getbootstrap.com/docs/4.3/examples/sticky-footer/sticky-footer.css"
        integrity="sha384-BZcSuyq3cmGi/E2JVjs3C6PoDcVs/8OKuDZjyXOY/ntKcIbMt8iD4g+LyeSuJX+t" crossorigin="anonymous">

    <style>
        main>.container {
            padding: 60px 15px 0;
        }

        .footer {
            background-color: #f5f5f5;
        }

        .footer>.container {
            padding-right: 15px;
            padding-left: 15px;
        }
    </style>
</head>

<body class="d-flex flex-column h-100">

    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
            <a class="navbar-brand" href="/">
                <img src="/mstile-144x144.png" style="width:32px;height:32px;">
                &nbsp;Brew Bubbles
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01"
                aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarColor01">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">Home</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="/settings/">Settings <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/help/">Help</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/about/">About</a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <main role="main" class="flex-shrink-0">

        <div class="container" id="settingsapp">
            <!-- Container -->
            <h1 class="mt-5">Device Settings</h1>

            <div class="card border-dark mb-3">
                <!-- Controller Settings -->
                <div class="card-header">
                    <h4 class="card-title">Controller Settings</h4>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            <form action="/settings/update/" method="POST">
                                <div class="form-group row">
                                    <label for="mdnsID" class="col-sm-2 col-form-label" data-toggle="tooltip"
                                        title="Change mDNS name (the hostname part in http://hostname.local/)  Do not add the &ldquo;.local&rdquo; to the name">mDNS
                                        ID</label>
                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" name="mdnsID" id="mdnsID"
                                            placeholder="brewbubbles" value="settings.mdnsID">
                                    </div>
                                    <div class="col-sm-2"><button type="submit" class="btn btn-primary">Update</button>
                                    </div>
                                </div>
                            </form>
                        </li>
                    </ul>
                </div>
            </div> <!-- Controller Settings -->

            <div class="card border-dark mb-3">
                <!-- Temperature Settings -->
                <div class="card-header">
                    <h4 class="card-title">Temperature Settings</h4>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            <form action="/settings/update/" method="POST">
                                <div class="container">
                                    <fieldset class="form-group">
                                        <h5 class="legend">Temperature Format</h5>
                                        <div class="row justify-content-center">
                                            <div class="col">
                                                <p>&nbsp;</p>
                                            </div>
                                            <div class="col">
                                                <div class="form-check">
                                                    <input type="radio" id="tempInF" name="tempFormat"
                                                        class="custom-control-input" checked="">
                                                    <label data-toggle="tooltip"
                                                        title="Change the application display in Farenheit"
                                                        class="custom-control-label" for="tempInF">Farenheit</label>
                                                </div>
                                                <div class="form-check">
                                                    <label class="form-check-label">
                                                        <input type="radio" id="tempInC" name="tempFormat"
                                                            class="custom-control-input">
                                                        <label data-toggle="tooltip"
                                                            title="Change the application display in Celcius"
                                                            class="custom-control-label" for="tempInC">Celcius</label>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col">
                                                <p>&nbsp;</p>
                                            </div>
                                            <div class="col"><button type="submit"
                                                    class="btn btn-primary">Update</button></div>
                                            <div class="col">
                                                <p>&nbsp;</p>
                                            </div>
                                        </div>
                                    </fieldset>
                                    <hr class="my-4">
                                    <fieldset class="form-group">
                                        <h5 class="legend">Temperature Calibration</h5>
                                        <form action="/settings/update/" method="POST">
                                            <div class="form-group row">
                                                <label for="calAmbient" class="col-sm-2 col-form-label"
                                                    data-toggle="tooltip"
                                                    title="Value by which the Room teperature display will be offset">Room</label>
                                                <div class="col-sm-8">
                                                    <input type="text" class="form-control" name="calAmbient"
                                                        id="calAmbient" placeholder="0.0" value="settings.calAmbient">
                                                </div>
                                                <div class="col-sm-2"><button type="submit"
                                                        class="btn btn-primary">Update</button></div>
                                            </div>
                                        </form>

                                        <form action="/settings/update/" method="POST">
                                            <div class="form-group row">
                                                <label for="calVessel" class="col-sm-2 col-form-label"
                                                    data-toggle="tooltip"
                                                    title="Value by which the Vessel teperature display will be offset">Vessel</label>
                                                <div class="col-sm-8">
                                                    <input type="text" class="form-control" name="calVessel"
                                                        id="calVessel" placeholder="0.0" value="settings.calVessel">
                                                </div>
                                                <div class="col-sm-2"><button type="submit"
                                                        class="btn btn-primary">Update</button></div>
                                            </div>
                                        </form>
                                    </fieldset>
                                </div>
                            </form>
                        </li>
                </div>
            </div> <!-- Temperature Settings -->

            <div class="card border-dark mb-3">
                <!-- Target Settings -->
                <div class="card-header">
                    <h4 class="card-title">Target Settings</h4>
                </div>
                <div class="card-body">
                    <p class="card-text">These settings control how Brew Bubbles talks to an HTML endpoint such as
                        <a href="https://www.brewpiremix.com/">BrewPi Remix</a> or
                        <a href="https://www.fermentrack.com/">Fermentrack</a>. To disable pushing to the endpoint,
                        delete the URL.
                    </p>

                    <form action="/settings/update/" method="POST">
                        <div class="form-group row">
                            <label for="endpointURL" class="col-sm-2 col-form-label" data-toggle="tooltip"
                                title="HTML Endpoint URL. Delete to disable pushing to an HTML Endpoint. Ports other than 80 need to be in the format of: http://foo.com:8080/page.php">Target</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" name="brewpiremixURL" id="brewpiremixURL"
                                    placeholder="http://brewpi.local/brewbubbles.php" value="settings.brewpiremixURL">
                            </div>
                            <div class="col-sm-2"><button type="submit" class="btn btn-primary">Update</button></div>
                        </div>
                    </form>

                    <form action="/settings/update/" method="POST">
                        <div class="form-group row">
                            <label for="endpointPushEvery" class="col-sm-2 col-form-label" data-toggle="tooltip"
                                title="How often (in seconds) to push data to HTML Endpoint">Frequency</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" name="endpointPushEvery" id="endpointPushEvery"
                                    placeholder="60" value="settings.endpointPushEvery">
                            </div>
                            <div class="col-sm-2"><button type="submit" class="btn btn-primary">Update</button></div>
                        </div>
                    </form>
                </div>
            </div> <!-- Target Settings -->

            <div class="card border-dark mb-3">
                <!-- Brewer's Friend Settings -->
                <div class="card-header">
                    <h4 class="card-title">Brewer's Friend Settings</h4>
                </div>
                <div class="card-body">
                    <p class="card-text">
                        These settings control how Brew Bubbles talks to <a
                            href="http://www.brewersfriend.com/">Brewer's
                            Friend.</a> With a premium account, Brewer's Friend supports logging brew-related data.
                        To find your API key; log into your Brewer's Friend account and go to Profile > Account.
                        Your API key will be a 40-character string of letters and numbers (not a URL).
                    </p>
                    <form action="/settings/update/" method="POST">
                        <div class="form-group row">
                            <label for="brewersFriendKey" class="col-sm-2 col-form-label" data-toggle="tooltip"
                                title="Enter the API key from your Brewer's Friend premium account">Brewer's Friend
                                Key</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" name="brewersFriendKey" id="brewersFriendKey"
                                    placeholder="000fa2ac454c1abf14ffa3" value="settings.brewersFriendKey">
                            </div>
                            <div class="col-sm-2"><button type="submit" class="btn btn-primary">Update</button></div>
                        </div>
                    </form>

                    <form action="/settings/update/" method="POST">
                        <div class="form-group row">
                            <label for="bfPushEvery" class="col-sm-2 col-form-label" data-toggle="tooltip"
                                title="How often (in minutes) to push data to Brewer's Friend">Push Frequency</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" name="endpointPushEvery" id="endpointPushEvery"
                                    placeholder="15" value="settings.endpointPushEvery">
                            </div>
                            <div class="col-sm-2"><button type="submit" class="btn btn-primary">Update</button></div>
                        </div>
                    </form>
                </div>
            </div> <!-- Brewer's Friend Settings -->

            <div class="card border-dark mb-3">
                <!-- Update Firmware -->
                <div class="card-header">
                    <h4 class="card-title">Update Firmware</h4>
                </div>
                <div class="card-body">
                    <p class="card-text">
                        Your Brew Bubbles can be updated over the internet to the latest version of the Brew Bubbles
                        firmware by clicking the "Update Firmware" button below.
                    </p>
                    <p class="card-text">
                        <a href="/ota/" class="btn btn-danger">Update Firmware</a>
                    </p>
                </div>
            </div> <!-- Update Firmware -->

            <div class="card border-dark mb-3">
                <!-- Reset WiFi -->
                <div class="card-header">
                    <h4 class="card-title">Reset WiFi</h4>
                </div>
                <div class="card-body">
                    <p class="card-text">
                        If you plan on relocating your Brew Bubbles to a new network, you can reset the WiFi connection
                        settings by clicking "Reset WiFi". You will need to perform the the original network setup again
                        by connecting to this device as an access point.
                    </p>
                    <p class="card-text">
                        <a href="/wifi/" class="btn btn-danger">Reset WiFi</a>
                    </p>
                </div>
            </div> <!-- Reset WiFi -->

        </div> <!-- Container -->

    </main>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.7/dist/vue.js"></script>

    <script type="text/javascript">
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        });

        var vm = new Vue({
            el: '#settingsapp',
            data: {
                settings: []
            },
            mounted: function () {
                this.getSettings();
            },
            methods: {
                getSettings: function () {
                    var xhr = new XMLHttpRequest();
                    var self = this;
                    xhr.open('GET', '/config/');
                    xhr.onload = function () {
                        self.settings = JSON.parse(xhr.responseText);
                    };
                    xhr.send()
                }
            }
        });
    </script>

    <footer class="footer mt-auto py-3">
        <div class="container">
            <span class="text-muted">Copyright &copy; 2019, Lee C. Bussy</span>
        </div>
    </footer>

</body>

</html>